(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57b74bd2"],{"0ca2":function(t,e,a){},"0e06":function(t,e,a){"use strict";var n=a("cfcc"),i=a.n(n);i.a},3191:function(t,e,a){"use strict";a.d(e,"e",(function(){return i})),a.d(e,"c",(function(){return s})),a.d(e,"d",(function(){return r})),a.d(e,"b",(function(){return l})),a.d(e,"a",(function(){return c}));var n=a("176e");function i(t){return Object(n["a"])({url:"/v1/square/list",method:"get",params:t})}function s(t){return Object(n["a"])({url:"/v1/carousel/list",method:"get",params:t})}function r(){return Object(n["a"])({url:"/v1/notice/list",method:"get"})}function l(t){return Object(n["a"])({url:"/v1/article/list",method:"get",params:t})}function c(t){return Object(n["a"])({url:"/Article/getRow/".concat(t),method:"get"})}},"374b":function(t,e,a){},4755:function(t,e,a){"use strict";var n=a("374b"),i=a.n(n);i.a},5182:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-container"},[a("Navbar",{attrs:{type:t.getType(),"bt-loading":t.btLoading,"write-status":t.writeStatus},on:{handleClick:t.handleClick}}),t._v(" "),a("div",{staticClass:"main"},[a(t.getType(),{tag:"components",attrs:{commit:t.commit,data:t.data,"bt-loading":t.btLoading,"write-status":t.writeStatus},on:{"update:btLoading":function(e){t.btLoading=e},"update:bt-loading":function(e){t.btLoading=e},"update:writeStatus":function(e){t.writeStatus=e},"update:write-status":function(e){t.writeStatus=e}}})],1)],1)},i=[],s=a("3191"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"write-header"},[a("nav",{staticClass:"navbar"},[a("div",{staticClass:"left"},[a("p",{staticClass:"logo",on:{click:function(e){return t.$router.push("/")}}},[a("span",{staticClass:"LLL"},[t._v("air")]),t._v(" "),a("span",{staticClass:"yh"},[t._v("db")])]),t._v(" "),a("p",{staticClass:"title"},[t._v(t._s(t.title))])]),t._v(" "),a("div",{staticClass:"right"},[t._v("\n      "+t._s(t.saveMsg[t.writeStatus])+"\n      "),a("el-button",{staticStyle:{padding:"8px 8px"},attrs:{type:"primary",size:"medium",loading:t.btLoading},on:{click:function(e){return t.handleClick("save")}}},[t._v(t._s(t.btMsg))])],1)])])},l=[],c={props:{type:{type:String,default:"Article"},btLoading:{type:Boolean,default:!1},writeStatus:{type:String,default:"create"}},data:function(){return{title:"",btMsg:"",saveMsg:{create:"",save:"保存中...",finish:"已保存草稿",unfinish:"保存失败"}}},mounted:function(){this.initData()},methods:{initData:function(){var t=this.$route.query.id;switch(this.type){case"Article":this.title="写文章",this.btMsg="发布文章",t&&(this.title="编辑文章",this.btMsg="保存编辑");break;case"Question":this.title="提问",this.btMsg="发布问题",t&&(this.title="编辑问题",this.btMsg="保存编辑");break}},handleClick:function(t,e){this.$emit("handleClick",t,e)}}},u=c,o=(a("b935"),a("2877")),d=Object(o["a"])(u,r,l,!1,null,"7ad54bc4",null),f=d.exports,h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"write-article"},[a("div",{staticClass:"title"},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[a("el-option",{attrs:{label:"原创",value:1}})],1),t._v(" "),a("el-input",{staticClass:"input-with-select",attrs:{autofocus:!0,placeholder:"标题: 和你讲讲我的故事"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),a("div",{staticClass:"config"},[a("el-select",{staticStyle:{"margin-right":"10px"},attrs:{size:"small",placeholder:"发布专栏(选填)",clearable:""},model:{value:t.form.column,callback:function(e){t.$set(t.form,"column",e)},expression:"form.column"}},t._l(t.columnList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),a("select-tags",{staticClass:"select-tags",attrs:{limit:5,placeholder:"请选择相关的标签"},model:{value:t.form.tags,callback:function(e){t.$set(t.form,"tags",e)},expression:"form.tags"}})],1),t._v(" "),a("mavon-editor",{staticClass:"mavon-editor",attrs:{value:t.form.content,"max-height":"100%"},on:{"update:value":function(e){return t.$set(t.form,"content",e)}}})],1)},p=[],m=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),g=(a("c5f6"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-select",{attrs:{multiple:"",size:t.size,"multiple-limit":t.limit,filterable:"",placeholder:t.placeholder},on:{focus:function(e){return t.getTags()}},model:{value:t.tags,callback:function(e){t.tags=e},expression:"tags"}},t._l(t.tagData,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)}),v=[],b=a("8020"),y={name:"SelectTags",props:{size:{type:String,default:"small"},limit:{type:Number,default:0},placeholder:{type:String,default:"请选择"},value:{type:Array}},data:function(){return{flag:"inner",tags:[],reqStatus:!1,tagData:[]}},watch:{tags:function(t){t===this.value?"outside"!==this.flag?this.$emit("update:value",t):this.flag="inner":this.$emit("update:value",t)},value:{handler:function(t){this.flag="outside",this.tags=t}}},created:function(){this.getTags()},methods:{getTags:function(){var t=this;this.reqStatus||Object(b["a"])().then((function(e){e.success&&(t.reqStatus=!0,t.tagData=e.content)}))}}},w=y,C=Object(o["a"])(w,g,v,!1,null,"a0d89ca2",null),$=C.exports,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mavon-editor"},[a("div",{staticClass:"header"}),t._v(" "),a("mavon-editor",{staticClass:"editor",style:"max-height: "+t.maxHeight,attrs:{"font-size":"13px",placeholder:t.placeholder,toolbars:t.initToolbars(),subfield:!0},model:{value:t.editorValue,callback:function(e){t.editorValue=e},expression:"editorValue"}})],1)},k=[],O={props:{value:{type:String},placeholder:{type:String,default:"那些值得记录或者分享的..."},maxHeight:{type:String,default:"500px"}},data:function(){return{flag:"inner",editorValue:""}},watch:{editorValue:function(t){t===this.value?"outside"!==this.flag?this.$emit("update:value",t):this.flag="inner":this.$emit("update:value",t)},value:{handler:function(t){this.flag="outside",this.editorValue=t}}},methods:{initToolbars:function(){return{bold:!0,italic:!0,header:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,fullscreen:!0,readmodel:!0,help:!0,preview:!0}}}},S=O,j=(a("0e06"),a("97db"),Object(o["a"])(S,_,k,!1,null,"17c8ad1a",null)),x=j.exports,q=a("176e");function L(t){return Object(q["a"])({url:"/apis/bbs/v1/article/create",method:"post",data:t})}function T(t){return Object(q["a"])({url:"/apis/bbs/v1/article/update",method:"put",data:t})}function M(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function V(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?M(a,!0).forEach((function(e){Object(m["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):M(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var A={components:{SelectTags:$,MavonEditor:x},props:{data:{type:Object,default:function(){return{}}},writeStatus:{type:String,default:"create"},commit:{type:Number,default:0},btLoading:{type:Boolean,default:!1}},data:function(){return{columnList:[],timer:null,form:{id:"",type:1,title:"",column_id:"",tags:[],content:""}}},watch:{data:function(t){for(var e in t)e in this.form&&(this.form[e]=t[e]);this.form.tags=t.tagList.map((function(t){return t.id})),clearTimeout(this.timer)},"form.title":function(){this.dataChange()},"form.tags":function(){this.dataChange()},"form.content":function(t){this.dataChange()},commit:function(t){var e=this,a=this.form,n=this.check(a);if(!n.success)return this.$message({showClose:!0,message:n.message,type:"error",duration:3500}),void this.$emit("update:btLoading",!1);var i=a.id?T:L;i(V({},a,{flag:3})).then((function(t){if(e.$emit("update:btLoading",!1),t.success){var n=a.id||t.content.id;e.$router.push({path:"/columns/article/".concat(n)})}e.$message({showClose:!0,message:t.success?"发布成功":"发布失败",type:t.success?"success":"error",duration:3500})})).catch((function(){e.$emit("update:btLoading",!1)}))}},methods:{dataChange:function(){var t=this;this.$emit("update:writeStatus","save");var e=this.form,a=e.id?T:L;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){e.title||(e.title="未指定标题的文章"),a(e).then((function(a){a.success?(e.id||(e.id=a.content.id),t.$emit("update:writeStatus","finish")):t.$emit("update:writeStatus","unfinish")})).catch((function(){t.$emit("update:writeStatus","unfinish")}))}),1e3)},validateFrom:function(){},check:function(t){for(var e,a=[{label:"类型",value:t.type,rules:["notnull"]},{label:"文章标题",value:t.title,rules:["notnull"]},{label:"标签",value:t.tags,rules:["notnull"]},{label:"内容",value:t.content,rules:["notnull"]}],n=!0,i=0,s=a;i<s.length;i++){var r=s[i];if(!this.$validate(r).success)return e=this.$validate(r).message,n=!1,{success:n,message:e}}return{success:n,message:e}}}},E=A,D=(a("4755"),Object(o["a"])(E,h,p,!1,null,"d494f3f8",null)),P=D.exports,z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"write-article"},[a("div",{staticClass:"title"},[a("el-input",{staticClass:"input-with-select",attrs:{autofocus:!0,placeholder:"标题: 一句话说清问题，用问号结尾"},model:{value:t.query.title,callback:function(e){t.$set(t.query,"title",e)},expression:"query.title"}})],1),t._v(" "),a("div",{staticClass:"config"},[a("el-select",{staticStyle:{"margin-right":"10px"},attrs:{size:"small",placeholder:"选择提问模板(可选)",clearable:""},model:{value:t.templateValue,callback:function(e){t.templateValue=e},expression:"templateValue"}},t._l(t.templateList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),a("select-tags",{staticClass:"select-tags",attrs:{limit:5,placeholder:"请选择相关的标签"},model:{value:t.query.tags,callback:function(e){t.$set(t.query,"tags",e)},expression:"query.tags"}})],1),t._v(" "),a("mavon-editor",{staticClass:"mavon-editor",attrs:{value:t.query.content,"max-height":"100%",placeholder:t.placeholder},on:{"update:value":function(e){return t.$set(t.query,"content",e)}}})],1)},N=[],Q={components:{SelectTags:$,MavonEditor:x},data:function(){return{templateValue:"",templateList:[{label:"开发实战相关",value:1},{label:"编程题目相关",value:2},{label:"工具软件相关",value:3}],placeholder:"请描述你的问题...",query:{type:"1",title:"",tags:[],content:""}}},watch:{templateValue:function(t){t?this.getTemplate(t):this.query.content=""}},methods:{getTemplate:function(t){switch(t){case 1:this.query.content="\n### 问题描述\n\n\n### 问题出现的环境背景及自己尝试过哪些方法\n\n\n### 相关代码\n// 请把代码文本粘贴到下方（请勿用图片代替代码）\n\n\n### 你期待的结果是什么？实际看到的错误信息又是什么？\n";break;case 2:this.query.content="\n### 题目描述\n\n\n### 题目来源及自己的思路\n\n\n### 相关代码\n// 请把代码文本粘贴到下方（请勿用图片代替代码）\n\n\n### 你期待的结果是什么？实际看到的错误信息又是什么？\n";break;case 3:this.query.content="\n### 问题描述\n\n\n### 问题出现的平台版本及自己尝试过哪些方法\n\n\n### 相关代码\n// 请把代码文本粘贴到下方（请勿用图片代替代码）\n\n\n### 你期待的结果是什么？实际看到的错误信息又是什么？\n";break}}}},B=Q,H=(a("d6a7"),Object(o["a"])(B,z,N,!1,null,"dfb1f32e",null)),I=H.exports,J={components:{Navbar:f,Article:P,Question:I},data:function(){return{commit:0,btLoading:!1,writeStatus:"",data:{}}},mounted:function(){this.getArticleInfo()},methods:{getType:function(){switch(this.$route.query.type){case"ask":return"Question";case"write":return"Article"}},getArticleInfo:function(){var t=this;this.$route.query.id&&Object(s["a"])(this.$route.query.id).then((function(e){e.success?t.data=e.content[0]:t.$router.push("/404")}))},handleClick:function(t,e){switch(t){case"save":this.btLoading=!0,this.commit=Math.random();break}}}},F=J,R=(a("90b5"),Object(o["a"])(F,n,i,!1,null,"7a2bb41a",null));e["default"]=R.exports},"63a4":function(t,e,a){},8020:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return s}));var n=a("176e");function i(t){return Object(n["a"])({url:"/apis/bbs/v1/TagType/getAll",method:"get",params:t})}function s(t){return Object(n["a"])({url:"/apis/bbs/v1/Tag/getAll",method:"get",params:t})}},"90b5":function(t,e,a){"use strict";var n=a("c60d"),i=a.n(n);i.a},"97db":function(t,e,a){"use strict";var n=a("c9d1"),i=a.n(n);i.a},b935:function(t,e,a){"use strict";var n=a("63a4"),i=a.n(n);i.a},c60d:function(t,e,a){},c9d1:function(t,e,a){},cfcc:function(t,e,a){},d6a7:function(t,e,a){"use strict";var n=a("0ca2"),i=a.n(n);i.a}}]);